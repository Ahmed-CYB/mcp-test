# OpenLDAP Configuration for CentOS Enterprise Staging

include         /etc/openldap/schema/core.schema
include         /etc/openldap/schema/cosine.schema
include         /etc/openldap/schema/inetorgperson.schema
include         /etc/openldap/schema/nis.schema

pidfile         /var/run/openldap/slapd.pid
argsfile        /var/run/openldap/slapd.args

# Database configuration
database        mdb
suffix          "dc=staging,dc=local"
rootdn          "cn=admin,dc=staging,dc=local"
rootpw          {SSHA}staging_admin_password_hash

directory       /var/lib/ldap

# Indices
index objectClass eq
index cn,uid eq
index uidNumber,gidNumber eq
index memberUid eq

# Access controls
access to attrs=userPassword,shadowLastChange
        by dn="cn=admin,dc=staging,dc=local" write
        by anonymous auth
        by self write
        by * none

access to dn.base="" by * read

access to *
        by dn="cn=admin,dc=staging,dc=local" write
        by * read

# TLS configuration
TLSCertificateFile /etc/ssl/certs/staging-ldap.crt
TLSCertificateKeyFile /etc/ssl/private/staging-ldap.key
TLSCACertificateFile /etc/ssl/certs/staging-ca.crt

# Logging
loglevel 256