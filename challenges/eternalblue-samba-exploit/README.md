# eternalblue-samba-exploit

## Description
A Linux Samba server is running with a misconfiguration that makes it vulnerable to EternalBlue-style attacks (MS17-010). The server has anonymous access enabled and weak SMB protocol settings. Your goal is to exploit the SMB service to gain access and retrieve the flag.

## Scenario
You are conducting a penetration test on a corporate network. Intelligence suggests that a file server is running an outdated Samba configuration that may be vulnerable to the infamous EternalBlue exploit (CVE-2017-0144). The server is believed to contain sensitive documents. Your task is to identify the vulnerability, exploit the SMB service, and retrieve the classified flag.

## Difficulty
medium

## Machines
- **attacker** (attacker): 172.28.145.3 - ssh
- **victim** (victim): 172.28.145.90 - samba, ssh
## Victim credentials
- **victim**: `target` / `Temp123!`

## Hints
1. Start by scanning the target for open ports, particularly SMB-related services
2. The Samba server allows anonymous access - try connecting without credentials
3. Look for misconfigurations in the SMB protocol settings that might make it vulnerable to EternalBlue-style attacks

## Flag Format
CTF{...}

## Solution (Samba)

1. **Scan the victim** for SMB ports: `nmap -p 139,445 --open <victim_ip>`. (Port 139 = NetBIOS, 445 = SMB; both are normal for Samba.)
2. **List shares** (no password): `smbclient -L //<victim_ip> -N`. If you see "Protocol negotiation... SMB1" or "Unable to connect with SMB1", ignore itâ€”the share list still succeeded. To avoid the message, use: `smbclient -L //<victim_ip> -N --option='client min protocol=SMB2'`.
3. **Connect to the share**: `smbclient //<victim_ip>/share -N`.
4. **List and get the flag**: `ls`, then `get flag.txt`, then `cat flag.txt` (or open it locally).

