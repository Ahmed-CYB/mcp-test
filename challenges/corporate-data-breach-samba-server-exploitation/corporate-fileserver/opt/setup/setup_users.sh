#!/bin/bash
# User setup script for corporate file server

# Create system users
sudo useradd -m -s /bin/bash consultant
sudo useradd -m -s /bin/bash staff_user  
sudo useradd -m -s /bin/bash backup_admin

# Set passwords
echo 'consultant:consult123' | sudo chpasswd
echo 'staff_user:staff2024' | sudo chpasswd
echo 'backup_admin:backup_secure_pass' | sudo chpasswd

# Create staff group
sudo groupadd staff
sudo usermod -a -G staff staff_user
sudo usermod -a -G staff consultant

# Create samba directories
sudo mkdir -p /srv/samba/{public,clients,temp,backup}

# Set permissions
sudo chown -R nobody:nogroup /srv/samba/public
sudo chown -R root:staff /srv/samba/clients
sudo chown -R nobody:nogroup /srv/samba/temp
sudo chown -R root:root /srv/samba/backup

sudo chmod 755 /srv/samba/public
sudo chmod 770 /srv/samba/clients
sudo chmod 777 /srv/samba/temp
sudo chmod 755 /srv/samba/backup

# Add samba users
sudo smbpasswd -a consultant -n
sudo smbpasswd -a staff_user -n

echo "Setup complete. Samba users created with no passwords for CTF challenge."