# SNMP Configuration for Backup System
# WARNING: This configuration has security issues for CTF purposes

# Community strings
rocommunity public default
rwcommunity private default

# System information
sysLocation    Corporate Backup Facility - Building C
sysContact     backup-admin@corpnet.local
sysServices    72

# Allow null sessions for backup monitoring
com2sec notConfigUser  default       
com2sec configUser     default       private
com2sec publicUser     default       public

group notConfigGroup v1           notConfigUser
group notConfigGroup v2c          notConfigUser
group configGroup    v1           configUser
group configGroup    v2c          configUser
group publicGroup    v1           publicUser
group publicGroup    v2c          publicUser

# Vulnerable view configuration
view all    included  .1                               80
view system included  .1.3.6.1.2.1.1                   
view system included  .1.3.6.1.2.1.25.1                

# Access control with null session vulnerability
access notConfigGroup ""      any       noauth    exact  all    none   none
access configGroup    ""      any       noauth    exact  all    all    none
access publicGroup    ""      any       noauth    exact  all    none   none

# Custom OID for backup system status
extend .1.3.6.1.4.1.2021.8.1 backup-status /usr/local/bin/backup_check.sh
extend .1.3.6.1.4.1.2021.8.2 backup-files /usr/local/bin/list_backups.sh
extend .1.3.6.1.4.1.2021.8.3 backup-config /usr/local/bin/show_config.sh

# Logging
logTimestamp yes
logOption f /var/log/snmpd.log