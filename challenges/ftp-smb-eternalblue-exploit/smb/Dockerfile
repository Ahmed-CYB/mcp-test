FROM ubuntu:22.04
RUN apt-get update && apt-get install -y samba
COPY smb.conf /etc/samba/smb.conf
RUN useradd -M -s /sbin/nologin smbuser && echo 'smbuser:password123' | smbpasswd -a smbuser -s
RUN mkdir -p /srv/samba/share && echo 'CTF{ftp_anonymous_login_and_eternalblue_exploit_2024}' > /srv/samba/share/flag.txt && chmod 644 /srv/samba/share/flag.txt
EXPOSE 445
CMD ["smbd", "-F", "-S"]