FROM debian:bookworm-slim
RUN apt-get update && apt-get install -y vsftpd && rm -rf /var/lib/apt/lists/*
RUN mkdir -p /var/run/vsftpd/empty /srv/ftp/public /srv/ftp/private
RUN echo 'anonymous_enable=YES' >> /etc/vsftpd.conf && \
    echo 'local_enable=NO' >> /etc/vsftpd.conf && \
    echo 'write_enable=NO' >> /etc/vsftpd.conf && \
    echo 'anon_root=/srv/ftp/public' >> /etc/vsftpd.conf
COPY flag.txt /srv/ftp/public/flag.txt
RUN chmod 444 /srv/ftp/public/flag.txt
EXPOSE 21
CMD ["vsftpd", "/etc/vsftpd.conf"]
